<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ... (keep the existing head content) ... -->
</head>
<body>
    <div class="container">
        <h1>PackeTweet</h1>
        <input type="text" id="tweetUrl" placeholder="Paste tweet URL here">
        <button onclick="processTweet()">Process Tweet</button>
        <div id="status"></div>
        <div class="process-steps">
            <div class="step" id="step1">
                <span class="step-icon">âšª</span> Capturing screenshot
            </div>
            <div class="step" id="step2">
                <span class="step-icon">âšª</span> Uploading to S3
            </div>
            <div class="step" id="step3">
                <span class="step-icon">âšª</span> Posting to Instagram
            </div>
        </div>
        <div id="screenshotContainer" style="display: none;">
            <img id="screenshotImage" alt="Tweet Screenshot">
        </div>
    </div>

    <div class="footer">
        Created by Shubhankar Kalra
    </div>

    <script>
        function updateStepStatus(stepId, status) {
            const step = document.getElementById(stepId);
            const icon = step.querySelector('.step-icon');
            if (status === 'complete') {
                icon.textContent = 'âœ…';
                icon.classList.add('complete');
            } else if (status === 'in-progress') {
                icon.textContent = 'ðŸ”„';
                icon.classList.add('in-progress');
            }
        }

        function resetSteps() {
            for (let i = 1; i <= 3; i++) {
                const step = document.getElementById(`step${i}`);
                const icon = step.querySelector('.step-icon');
                icon.textContent = 'âšª';
                icon.classList.remove('complete', 'in-progress');
            }
        }

        function processTweet() {
            const tweetUrl = document.getElementById('tweetUrl').value;
            const statusDiv = document.getElementById('status');
            const screenshotContainer = document.getElementById('screenshotContainer');
            statusDiv.textContent = 'Processing tweet...';
            screenshotContainer.style.display = 'none';
            resetSteps();

            // Extract tweet ID from URL
            const tweetId = tweetUrl.split('/').pop().split('?')[0];

            updateStepStatus('step1', 'in-progress');
            fetch(`/api/tweet/${tweetId}/process`, {
                method: 'POST',
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateStepStatus('step1', 'complete');
                    updateStepStatus('step2', 'complete');
                    updateStepStatus('step3', 'complete');
                    statusDiv.textContent = 'Tweet processed and posted to Instagram!';
                    
                    // Display the screenshot
                    const img = document.getElementById('screenshotImage');
                    img.src = data.screenshotUrl;
                    screenshotContainer.style.display = 'block';
                } else {
                    throw new Error(data.error || 'Failed to process tweet');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                statusDiv.textContent = 'Error: ' + error.message;
            });
        }
    </script>
</body>
</html>